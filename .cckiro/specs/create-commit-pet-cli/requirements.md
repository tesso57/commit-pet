# commit-pet 要件定義書

## 1. 概要

commit-petは、Gitのコミットを"エサ"としてターミナル内のペットを育成するタマゴッチ風のCLIツールです。開発者のコミット習慣を楽しくゲーミフィケーションし、継続的な開発活動を促進します。

## 2. 機能要件

### 2.1 コアコマンド

#### 2.1.1 `commit-pet feed`

- コミット後に実行することでペットにエサを与える
- 前回のfeed以降のコミット数を経験値として加算
- 経験値に応じてペットの成長ステージを更新
- 実行後、現在のペットの状態を表示

#### 2.1.2 `commit-pet status`

- 現在のペットの状態をInk UIで表示
- 表示内容：
  - ペットのASCIIアート（成長ステージに応じた絵）
  - 現在の経験値とステージ
  - 次のステージまでの必要経験値
  - 最終更新日時
  - プログレスバー（ink-progress-bar使用）

### 2.2 成長システム

#### ステージ定義

1. **卵（Egg）**: 0-4 exp
2. **ヒヨコ（Chick）**: 5-14 exp
3. **ニワトリ（Chicken）**: 15-29 exp
4. **ドラゴン（Dragon）**: 30+ exp

#### 経験値計算

- 経験値 = 前回feed実行時から現在までのコミット数
- `git log`を使用して、lastSha以降のコミットをカウント

### 2.3 データ永続化

#### 状態ファイル

- パス: `$XDG_CONFIG_HOME/commit-pet/state.json` または `~/.config/commit-pet/state.json`
- 保存データ:
  ```json
  {
    "stage": "egg | chick | chicken | dragon",
    "exp": number,
    "lastSha": string,
    "updatedAt": string (ISO 8601)
  }
  ```

### 2.4 UI/UX要件

#### ターミナルUI

- Ink v5を使用したリッチなターミナルUI
- カラフルで視覚的に楽しいASCIIアート表示
- 進捗がわかりやすいプログレスバー
- レスポンシブなレイアウト（ターミナルサイズに適応）

#### エラーハンドリング

- Gitリポジトリ外での実行時は親切なエラーメッセージ
- 状態ファイルの破損時は自動復旧（初期状態にリセット）
- コミットが存在しない場合の適切な案内

## 3. 非機能要件

### 3.1 パフォーマンス

- コマンド実行は即座に（1秒以内）
- Git履歴の取得は効率的に（必要最小限のデータのみ）

### 3.2 互換性

- Node.js 22以上をサポート
- macOS, Linux, Windows（WSL含む）で動作
- Git 2.0以上が必要

### 3.3 インストール

- npm経由でグローバルインストール可能
- `@tesso/commit-pet`としてパッケージ公開
- バイナリ名: `commit-pet`

### 3.4 拡張性

- 将来的な機能追加を考慮したモジュール設計
- プラグインシステムは初期バージョンでは不要

## 4. 制約事項

- 外部APIへの依存なし（完全ローカル動作）
- 初期バージョンではシングルペットのみ（マルチペット非対応）
- Git フック自動設定は手動設定を推奨（自動化は将来バージョン）

## 5. 将来の拡張予定

- `commit-pet watch`: リアルタイム監視モード
- Git フック自動生成: `commit-pet hook install`
- 通知連携: Slack, Discord等への投稿
- カスタムアート: ユーザー定義のASCIIアート対応
- マルチペット: 複数リポジトリで個別のペット育成
